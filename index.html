<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asistan Pro - Resmi S√ºr√ºm</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #f8fafc; color: #1e293b; }
        .glass-card { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.2); }
        .gradient-bg { background: linear-gradient(135deg, #4338ca 0%, #6366f1 100%); }
        .tab-active { background: white; color: #4338ca; box-shadow: 0 4px 12px rgba(0,0,0,0.05); }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        const { 
          Lock, Plus, Trash2, CheckCircle, XCircle, Users, RotateCw, Trophy, 
          BookOpen, FileText, LayoutDashboard, Star, Zap, Trash 
        } = lucideReact;

        function App() {
            const [currentPage, setCurrentPage] = useState('dashboard');
            const [selectedClass, setSelectedClass] = useState(null);
            const [classes, setClasses] = useState([]);
            const [students, setStudents] = useState([]);
            const [homeworks, setHomeworks] = useState([]);
            const [isLocked, setIsLocked] = useState(true);
            const [rotation, setRotation] = useState(0);
            const [lastWinner, setLastWinner] = useState(null);
            
            const TEACHER_PIN = "1234";

            // --- VERƒ∞ Y√ñNETƒ∞Mƒ∞ ---
            useEffect(() => {
                const saved = localStorage.getItem('asistan_pro_v2');
                if (saved) setClasses(JSON.parse(saved));
            }, []);

            useEffect(() => {
                if (selectedClass) {
                    const s = localStorage.getItem(`s_${selectedClass.id}`);
                    const h = localStorage.getItem(`h_${selectedClass.id}`);
                    setStudents(s ? JSON.parse(s) : []);
                    setHomeworks(h ? JSON.parse(h) : []);
                }
            }, [selectedClass]);

            const checkAccess = (action) => {
                if (!isLocked) { action(); return; }
                const pin = prompt("√ñƒüretmen PIN Kodunu Girin:");
                if (pin === TEACHER_PIN) { setIsLocked(false); action(); }
                else { alert("PIN Hatalƒ±!"); }
            };

            const saveClasses = (newList) => {
                setClasses(newList);
                localStorage.setItem('asistan_pro_v2', JSON.stringify(newList));
            };

            // --- ƒ∞≈ûLEMLER ---
            const addClass = () => {
                const name = prompt("Sƒ±nƒ±f Adƒ± (√ñrn: 9-A):");
                if (name) saveClasses([...classes, { id: Date.now(), name }]);
            };

            const deleteClass = (id, e) => {
                e.stopPropagation();
                checkAccess(() => {
                    if (confirm("Bu sƒ±nƒ±fƒ± silmek istiyor musunuz?")) {
                        saveClasses(classes.filter(c => c.id !== id));
                    }
                });
            };

            const addStudents = () => {
                const raw = prompt("√ñƒürenci No ve ƒ∞simleri yapƒ±≈ütƒ±rƒ±n (Her satƒ±ra bir ki≈üi):");
                if (raw) {
                    const parsed = raw.split('\n').filter(l => l.trim()).map(l => ({ id: Math.random(), name: l, points: 0 }));
                    const newList = [...students, ...parsed];
                    setStudents(newList);
                    localStorage.setItem(`s_${selectedClass.id}`, JSON.stringify(newList));
                }
            };

            const addHomework = () => {
                const title = prompt("√ñdev Konusu:");
                if (title) {
                    const newHw = { id: Date.now(), title, date: new Date().toLocaleDateString(), results: {} };
                    const newList = [...homeworks, newHw];
                    setHomeworks(newList);
                    localStorage.setItem(`h_${selectedClass.id}`, JSON.stringify(newList));
                }
            };

            return (
                <div className="min-h-screen">
                    {/* √úst Navigasyon */}
                    <nav className="gradient-bg text-white p-4 sticky top-0 z-50 shadow-xl">
                        <div className="max-w-7xl mx-auto flex justify-between items-center">
                            <div className="flex items-center gap-3 cursor-pointer" onClick={() => {setCurrentPage('dashboard'); setSelectedClass(null);}}>
                                <div className="bg-white/20 p-2 rounded-xl"><LayoutDashboard size={24}/></div>
                                <h1 className="text-xl font-black tracking-tighter uppercase">Asistan <span className="text-yellow-400">Pro</span></h1>
                            </div>
                            <button onClick={() => isLocked ? checkAccess(()=>{}) : setIsLocked(true)} 
                                className={`px-5 py-2 rounded-2xl font-bold transition flex items-center gap-2 ${isLocked ? 'bg-red-500/20 text-red-100' : 'bg-green-500 shadow-lg shadow-green-500/40'}`}>
                                {isLocked ? <Lock size={18}/> : <RotateCw size={18}/>}
                                {isLocked ? "Kƒ∞Lƒ∞TLƒ∞" : "A√áIK"}
                            </button>
                        </div>
                    </nav>

                    <main className="max-w-7xl mx-auto p-6 md:p-10">
                        {currentPage === 'dashboard' && (
                            <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
                                <div onClick={() => checkAccess(addClass)} className="h-48 border-4 border-dashed border-slate-300 rounded-[2.5rem] flex flex-col items-center justify-center text-slate-400 hover:border-indigo-500 hover:text-indigo-600 cursor-pointer transition-all bg-white/50">
                                    <Plus size={40} className="mb-2"/>
                                    <span className="font-bold text-lg">Yeni Sƒ±nƒ±f Olu≈ütur</span>
                                </div>
                                {classes.map(c => (
                                    <div key={c.id} onClick={() => { setSelectedClass(c); setCurrentPage('students'); }} 
                                        className="bg-white p-8 rounded-[2.5rem] shadow-sm hover:shadow-2xl transition-all border-b-8 border-indigo-600 relative group cursor-pointer">
                                        <button onClick={(e) => deleteClass(c.id, e)} className="absolute top-6 right-6 text-red-300 opacity-0 group-hover:opacity-100 transition hover:text-red-600"><Trash2 size={24}/></button>
                                        <div className="bg-indigo-50 w-14 h-14 rounded-2xl flex items-center justify-center mb-6 text-indigo-600"><Users size={28}/></div>
                                        <h3 className="text-2xl font-black text-slate-800">{c.name}</h3>
                                        <p className="text-slate-400 font-bold text-xs uppercase mt-2 tracking-widest">Y√∂netmek ƒ∞√ßin Tƒ±klayƒ±n</p>
                                    </div>
                                ))}
                            </div>
                        )}

                        {selectedClass && (
                            <div className="space-y-8 animate-in fade-in duration-500">
                                {/* Alt Sekmeler */}
                                <div className="bg-slate-200/60 p-1.5 rounded-2xl flex gap-1 w-fit">
                                    {[
                                        {id:'students', label:'Liste', icon:<Users size={18}/>},
                                        {id:'homework', label:'√ñdevler', icon:<BookOpen size={18}/>},
                                        {id:'wheel', label:'Kura √áarkƒ±', icon:<RotateCw size={18}/>},
                                        {id:'leaderboard', label:'Sƒ±ralama', icon:<Trophy size={18}/>}
                                    ].map(tab => (
                                        <button key={tab.id} onClick={() => setCurrentPage(tab.id)} 
                                            className={`flex items-center gap-2 px-6 py-2.5 rounded-xl font-black text-sm transition-all ${currentPage === tab.id ? 'tab-active' : 'text-slate-500 hover:text-indigo-600'}`}>
                                            {tab.icon} {tab.label.toUpperCase()}
                                        </button>
                                    ))}
                                </div>

                                {currentPage === 'students' && (
                                    <div className="bg-white rounded-[2.5rem] shadow-xl overflow-hidden border border-slate-100">
                                        <div className="p-8 border-b flex justify-between items-center">
                                            <h2 className="text-2xl font-black text-indigo-900 uppercase tracking-tighter">{selectedClass.name} / √ñƒûRENCƒ∞ Lƒ∞STESƒ∞</h2>
                                            <button onClick={() => checkAccess(addStudents)} className="bg-indigo-600 text-white px-8 py-3 rounded-2xl font-bold shadow-lg shadow-indigo-200 hover:bg-indigo-700 transition">Hƒ±zlƒ± Ekle</button>
                                        </div>
                                        <div className="p-4 grid grid-cols-1 md:grid-cols-2 gap-4">
                                            {students.map((s, idx) => (
                                                <div key={s.id} className="bg-slate-50 p-5 rounded-2xl flex justify-between items-center border border-slate-100">
                                                    <span className="font-bold text-slate-700">{idx+1}. {s.name}</span>
                                                    <button onClick={() => {
                                                        const newList = students.filter(x => x.id !== s.id);
                                                        setStudents(newList);
                                                        localStorage.setItem(`s_${selectedClass.id}`, JSON.stringify(newList));
                                                    }} className="text-red-300 hover:text-red-500"><XCircle size={20}/></button>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}

                                {currentPage === 'homework' && (
                                    <div className="bg-white rounded-[2.5rem] p-8 shadow-xl">
                                        <div className="flex justify-between items-center mb-8">
                                            <h2 className="text-2xl font-black text-indigo-900">√ñDEV TAKƒ∞Bƒ∞</h2>
                                            <button onClick={() => checkAccess(addHomework)} className="bg-emerald-500 text-white px-8 py-3 rounded-2xl font-bold shadow-lg shadow-emerald-200">+ Yeni √ñdev Tanƒ±mla</button>
                                        </div>
                                        <div className="grid gap-4">
                                            {homeworks.map(hw => (
                                                <div key={hw.id} className="p-6 bg-slate-50 rounded-2xl border flex justify-between items-center">
                                                    <div>
                                                        <h3 className="font-bold text-lg text-slate-800">{hw.title}</h3>
                                                        <p className="text-xs text-slate-400 font-bold">{hw.date}</p>
                                                    </div>
                                                    <button className="text-indigo-600 font-bold hover:underline">Kontrol Et</button>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}

                                {currentPage === 'wheel' && (
                                    <div className="bg-indigo-900 rounded-[3rem] p-12 text-center text-white shadow-2xl flex flex-col items-center">
                                        <div style={{ transform: `rotate(${rotation}deg)`, transition: 'transform 3s cubic-bezier(0.15, 0, 0.15, 1)' }} 
                                            className="w-72 h-72 md:w-96 md:h-96 rounded-full border-[12px] border-white/10 flex items-center justify-center relative bg-gradient-to-br from-indigo-500 to-purple-600 shadow-2xl mb-10">
                                            <Star size={100} className="opacity-10" />
                                            <div className="absolute -top-6 left-1/2 -translate-x-1/2 w-8 h-12 bg-yellow-400" style={{clipPath:'polygon(50% 100%, 0 0, 100% 0)'}}></div>
                                        </div>
                                        <button onClick={() => {
                                            const r = rotation + 1800 + Math.random() * 360;
                                            setRotation(r);
                                            setTimeout(() => {
                                                const winner = students[Math.floor(Math.random() * students.length)];
                                                setLastWinner(winner);
                                            }, 3000);
                                        }} className="bg-yellow-400 text-indigo-950 px-16 py-5 rounded-[2rem] font-black text-2xl hover:scale-105 transition shadow-2xl shadow-yellow-400/20">√áARKIBE≈ûER!</button>
                                        {lastWinner && <h2 className="mt-10 text-5xl font-black text-yellow-400 animate-bounce tracking-tighter">{lastWinner.name}</h2>}
                                    </div>
                                )}
                                
                                {currentPage === 'leaderboard' && (
                                    <div className="max-w-3xl mx-auto space-y-4">
                                        <h2 className="text-center text-3xl font-black text-slate-800 mb-8 uppercase tracking-widest italic">üèÜ Ba≈üarƒ± Sƒ±ralamasƒ±</h2>
                                        {students.sort((a,b)=>b.points-a.points).map((s, idx) => (
                                            <div key={s.id} className="bg-white p-6 rounded-[2rem] flex justify-between items-center shadow-sm border-l-[12px] border-indigo-600">
                                                <div className="flex items-center gap-6">
                                                    <span className="text-3xl font-black text-slate-200">#{idx+1}</span>
                                                    <span className="text-xl font-extrabold text-slate-700">{s.name}</span>
                                                </div>
                                                <div className="bg-indigo-50 px-8 py-3 rounded-2xl">
                                                    <span className="text-2xl font-black text-indigo-600">{s.points} XP</span>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                )}
                            </div>
                        )}
                    </main>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
